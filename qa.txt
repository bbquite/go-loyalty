TODO
убрать ключи в окружение

QA
джоины в pgx
nil для кастомных типов
примеры валидных заказов
POST /api/user/balance/withdraw списание баллов нужно использовать уже созданый заказ или это просто криэйт

----------

POST /api/user/register — регистрация пользователя; +
Возможные коды ответа:
200 — пользователь успешно зарегистрирован и аутентифицирован; +
400 — неверный формат запроса; +
409 — логин уже занят; +
500 — внутренняя ошибка сервера. +

Для передачи аутентификационных данных используйте механизм cookies или HTTP-заголовок Authorization. +

------------

POST /api/user/login — аутентификация пользователя; +

200 — пользователь успешно аутентифицирован; +
400 — неверный формат запроса; +
401 — неверная пара логин/пароль; +
500 — внутренняя ошибка сервера. +

Для передачи аутентификационных данных используйте механизм cookies или HTTP-заголовок Authorization. +

------------

POST /api/user/orders — загрузка пользователем номера заказа для расчёта; + 353718687463646

Хендлер доступен только аутентифицированным пользователям. +
Номер заказа может быть проверен на корректность ввода с помощью алгоритма Луна. +

200 — номер заказа уже был загружен этим пользователем; +
202 — новый номер заказа принят в обработку; +
400 — неверный формат запроса; +
401 — пользователь не аутентифицирован; +
409 — номер заказа уже был загружен другим пользователем; +
422 — неверный формат номера заказа; +
500 — внутренняя ошибка сервера. +

-----------

GET /api/user/orders — получение списка загруженных пользователем номеров заказов;

Хендлер доступен только авторизованному пользователю. +
Номера заказа в выдаче должны быть отсортированы по времени загрузки от самых новых к самым старым. +
Формат даты — RFC3339. +

200 — успешная обработка запроса. +
204 — нет данных для ответа. +
401 — пользователь не авторизован. +
500 — внутренняя ошибка сервера. +

-----------

GET /api/user/balance — получение текущего баланса счёта баллов лояльности пользователя;

Хендлер доступен только авторизованному пользователю. +

200 — успешная обработка запроса. +
401 — пользователь не авторизован. +
500 — внутренняя ошибка сервера. +

----------

POST /api/user/balance/withdraw — запрос на списание баллов с накопительного счёта в счёт оплаты нового заказа;

Хендлер доступен только авторизованному пользователю. +

200 — успешная обработка запроса;
401 — пользователь не авторизован;
402 — на счету недостаточно средств;
422 — неверный номер заказа;
500 — внутренняя ошибка сервера.

----------

GET /api/user/withdrawals — получение информации о выводе средств с накопительного счёта пользователем.

Хендлер доступен только авторизованному пользователю. +
Факты выводов в выдаче должны быть отсортированы по времени вывода от самых новых к самым старым. +
Формат даты — RFC3339. +

200 — успешная обработка запроса. +
204 — нет ни одного списания. +
401 — пользователь не авторизован. +
500 — внутренняя ошибка сервера. +
